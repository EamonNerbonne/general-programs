<?xml version="1.0" encoding="utf-8" ?> 
<!DOCTYPE html PUBLIC 
  "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
 <head>
  <title>Test: createrows.xsl</title>
  <script language="javascript" src="../js/JSUtil.js"></script>
  <script language="javascript" src="../js/XMLUtil.js"></script>
  <script language="javascript"><!--
function onwinload() {
   var files=new Object();
   files.count=2;
   function ldhand(prop) {
       function realhand(doc) {
           files[prop]=doc;
           files.count--;
           if (!(files.count)) whendone();
       }
       return realhand;
   }
   XMLUtil.loadXMLDoc("email-def.xml", ldhand("emaildef"));
   XMLUtil.loadXMLDoc("def2html.xsl", ldhand("xslt"));
 //  XMLUtil.loadXMLDoc("email.xml", ldhand("email"));
   function whendone() {
       var transdoc;
       transdoc=XMLUtil.transform((files.emaildef),(files.xslt));
       alert(transdoc.xml);
   //    transdoc=XMLUtil.transform((files.email),transdoc);
     //  alert(transdoc.xml);
   }
}
JSUtil.addObserver(window,"onload",onwinload);
  --></script>
 </head>
 <body>
 </body>
</html>